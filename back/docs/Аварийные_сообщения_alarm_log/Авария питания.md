# Авария "Авария питания. Ручной сброс"

# 1. Краткое описание:

Тип склада: все
Источники: сигнал "питание в норме", линукс оповещает о питании от батарейки

# 2. Условия:

- работает всегда

# 3. Путь к настройкам

Настройки -> Системные настройки -> Авария питания

# 4. Описание настроек

1. Количество отключений питания: кол-во переходов POS-терминала на питание от батареи или по сигналу (заводское значение: 3)
2. Время подсчета - время, в течении которого произошло n перключений на питание от батареи или сигнала (заводское значение: 30 мин)

# 5. Описание (программист)

Путь `src\control\extra\extralrm\def\battery\index.js`
Код `battery`

1. В аккумуляторе создается очередь состояний питания acc.queue, размер очереди зависит от настройки "Количество отключений питания"
2. Когда очередь стала >= "Количество отключений питания", то проверяем время между первым и последним изменением состояния.
3. Расчетная дельта меньше "Время подсчета" -> установка аварии
4. Сброс аварии: только оператором через мобильное/web приложение
